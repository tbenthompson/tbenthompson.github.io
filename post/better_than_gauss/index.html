<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gaussian quadrature is not optimal. | T. Ben Thompson</title>
<meta name="title" content="Gaussian quadrature is not optimal." />
<meta name="description" content="It&rsquo;s conventional wisdom that Gauss quadrature is the most point-efficient quadrature formula for analytic functions. But, it&rsquo;s not true! &ldquo;New quadrature formulas from conformal maps&rdquo; by Hale and Trefethen (2008) demonstrate that it&rsquo;s possible to have quadrature formulas that converge about 50% faster for analytic functions. The paper is quite accessible and I encourage you to read it, but I also wanted to help bring attention to it since it seems like it should be more well-known." />
<meta name="keywords" content="" />


<meta property="og:title" content="Gaussian quadrature is not optimal." />
<meta property="og:description" content="It&rsquo;s conventional wisdom that Gauss quadrature is the most point-efficient quadrature formula for analytic functions. But, it&rsquo;s not true! &ldquo;New quadrature formulas from conformal maps&rdquo; by Hale and Trefethen (2008) demonstrate that it&rsquo;s possible to have quadrature formulas that converge about 50% faster for analytic functions. The paper is quite accessible and I encourage you to read it, but I also wanted to help bring attention to it since it seems like it should be more well-known." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://tbenthompson.com/post/better_than_gauss/" />
<meta property="article:published_time" content="2021-06-14T00:00:00-04:00" />
<meta property="article:modified_time" content="2021-06-14T00:00:00-04:00" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Gaussian quadrature is not optimal."/>
<meta name="twitter:description" content="It&rsquo;s conventional wisdom that Gauss quadrature is the most point-efficient quadrature formula for analytic functions. But, it&rsquo;s not true! &ldquo;New quadrature formulas from conformal maps&rdquo; by Hale and Trefethen (2008) demonstrate that it&rsquo;s possible to have quadrature formulas that converge about 50% faster for analytic functions. The paper is quite accessible and I encourage you to read it, but I also wanted to help bring attention to it since it seems like it should be more well-known."/>



<meta itemprop="name" content="Gaussian quadrature is not optimal.">
<meta itemprop="description" content="It&rsquo;s conventional wisdom that Gauss quadrature is the most point-efficient quadrature formula for analytic functions. But, it&rsquo;s not true! &ldquo;New quadrature formulas from conformal maps&rdquo; by Hale and Trefethen (2008) demonstrate that it&rsquo;s possible to have quadrature formulas that converge about 50% faster for analytic functions. The paper is quite accessible and I encourage you to read it, but I also wanted to help bring attention to it since it seems like it should be more well-known.">
<meta itemprop="datePublished" content="2021-06-14T00:00:00-04:00" />
<meta itemprop="dateModified" content="2021-06-14T00:00:00-04:00" />
<meta itemprop="wordCount" content="541">



<meta itemprop="keywords" content="" />
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  body {
    font-family: sans-serif;
    margin: auto;
    padding: 20px;
    max-width: 720px;
    text-align: left;
    background-color: #fff;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: #444;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  strong,
  b {
    color: #222;
  }

  a {
    color: #3273dc;
     
  }

  .title {
    text-decoration: none;
    border: 0;
  }

  .title span {
    font-weight: 400;
  }

  nav a {
    margin-right: 10px;
  }

  textarea {
    width: 100%;
    font-size: 16px;
  }

  input {
    font-size: 16px;
  }

  content {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  img {
    max-width: 100%;
  }

  code {
    padding: 2px 5px;
    background-color: #f2f2f2;
  }

  pre code {
    display: block;
    padding: 5px;
    white-space: pre-wrap;
    font-size: 13px;
  }

  blockquote {
    border-left: 1px solid #999;
    color: #222;
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px;
    text-align: center;
  }

  .helptext {
    color: #777;
    font-size: small;
  }

  .errorlist {
    color: #eba613;
    font-size: small;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: #8b6fcb;
  }

  code.has-jax {
    -webkit-font-smoothing: antialiased;
    background: inherit !important;
    border: none !important;
    font-size: 100%;
  }
</style>
<script src="/js/mathjax_setup.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-114592151-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-114592151-1');
</script>
<link rel="stylesheet" href="/css/syntax.css">
</head>

<body>
  <header><nav><a href="/">Home</a>
<a href="/post">Posts</a>
<a href="/project">Past Projects</a>
<a href="/book">BIE Book</a>
</nav>
</header>
  <main>
<h2>Gaussian quadrature is not optimal.</h2>

<p>
  <i>
      
      <time datetime='2021-06-14' pubdate>
        14 Jun, 2021
      </time>
      
  </i>
</p>

<content>
  <p>It&rsquo;s conventional wisdom that Gauss quadrature is the most point-efficient quadrature formula for analytic functions. But, it&rsquo;s not true! <a href="http://www.cs.ox.ac.uk/files/731/NA-07-15.pdf">&ldquo;New quadrature formulas from conformal maps&rdquo; by Hale and Trefethen (2008)</a> demonstrate that it&rsquo;s possible to have quadrature formulas that converge about 50% faster for analytic functions. The paper is quite accessible and I encourage you to read it, but I also wanted to help bring attention to it since it seems like it should be more well-known.</p>
<h3 id="polynomials-vs-analytic-functions">Polynomials vs analytic functions</h3>
<p>So, where did the misconception that Gauss quadrature is the best possible quadrature rule for smooth functions? I think it comes from framing the problem in terms of the maximum order of polynomial that can be integrated exactly. By that metric, Gauss quadrature <strong>is</strong> the best that can be done. If we write down a quadrature rule like:</p>
<p>\begin{equation}
\int_{-1}^{1} f(x) dx \approx \sum_{k}^n w_k f(x_k)
\end{equation}</p>
<p>then there are $n$ points, $x_k$, and $n$ weights $w_k$. Solving a linear system for the points and weights that exactly integrate a polynomial results in a solvable linear system with $2n$ rows and columns. And a polynomial with order $2n-1$ has $2n$ coefficients, so Gauss quadrature is clearly optimal in the order of polynomial integrable with $N$ points and weights (this isn&rsquo;t a rigorous proof).</p>
<p>But, it <em>does not follow</em> that the best quadrature rule for small polynomials is also the best possible quadrature rule for general analytic functions. As the Hale and Trefethen paper demonstrates, Gauss quadrature is suboptimal by approximately a factor of $\pi/2$ in terms of the number of quadrature points required for a given level of error.</p>
<h3 id="just-give-me-a-quadrature-rule">Just give me a quadrature rule</h3>
<p>There are several formulas in the paper, but this one is particularly
\begin{align}
\tilde{I}_n(f) &amp;= \sum_k^n \tilde{w}_k f(\tilde{x}_k) , ~~~ \tilde{x}_k = w_kg&rsquo;(x_k), ~~~ \tilde{x}_k=g(x_k) \\<br>
g(s) &amp;= \frac{1}{53089}(40320s + 6720s^3 + 3024s^5 + 1800s^7 + 1225s^9)
\end{align}</p>
<h3 id="why-does-this-work">Why does this work?</h3>
<p>In traditional convergence proofs for Gaussian quadrature, we must assume a little bit more than just having an analytic integrand. The standard approach is to assume that $f(x)$ is analytic in an elliptical domain in the complex plane surrounding the real line segment $[-1, 1]$. The left side of the figure below is showing the right-hand half of such an ellipse. The thing to note is that this is an unbalanced regularity requirement:</p>
<ul>
<li>near $x=\pm 1$, $f(x)$ is allowed to have singularities or other non-analytic behavior very nearby.</li>
<li>on the other hand, near $x=0$, $f(x)$ has a very wide domain in which it is analytic.</li>
</ul>
<p>Basically, we&rsquo;re putting much more stringent requirements on the center of the domain than on the end points of the domain. The idea in the Hale and Trefethen is to perform a conformal mapping of this ellipse into a domain that is more balanced. This is demonstrated graphically in the figure below.</p>
<p><img src="/images/elliptic_gauss.png" alt="ellipse"></p>
<h3 id="does-this-actually-work">Does this actually work?</h3>
<p>For this, I&rsquo;ll just copy the figure from the paper. It depends on the integrand, but for many analytic functions, yes, the new quadrature rule is more point efficient! For further explanation of the successes and failures here, go take a look at the paper!</p>
<p><img src="/images/better_gauss.png" alt="ellipse"></p>
<h3 id="more-myths">More myths!</h3>
<p>Check out this <a href="https://people.maths.ox.ac.uk/trefethen/mythspaper.pdf">Lloyd Trefethen essay</a> for several other myths about polynomials and numerical methods.</p>

</content>


<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<div id="mc_embed_signup" style="padding: 20px 0 20px 0;">
  <form action="https://tbenthompson.us1.list-manage.com/subscribe/post?u=be25bc8a8ab56f1fb3e6651c2&amp;id=b407942450" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
      <label for="mce-EMAIL" style="font-weight: normal">If you enjoyed this post, please subscribe!</label>
      <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email@address.com" required>

    <div style="display:none">
      <input type="checkbox" value="1" name="group[377262][1]" id="mce-group[377262]-377262-0" checked>Posts
      <input type="checkbox" value="2" name="group[377262][2]" id="mce-group[377262]-377262-1" >BIEBook
    </div>
      
      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_be25bc8a8ab56f1fb3e6651c2_b407942450" tabindex="-1" value=""></div>
      <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
  </form>
</div>

<p>
  
</p>
<div id="remarkbox-div">
  <noscript>
    <iframe id=remarkbox-iframe src="https://my.remarkbox.com/embed?nojs=true" style="height:600px;width:100%;border:none!important" tabindex=0></iframe>
  </noscript>
</div>
<script src="https://my.remarkbox.com/static/js/iframe-resizer/iframeResizer.min.js"></script>
<script>
  var rb_owner_key = "7a2d47e9-98bb-11eb-9905-040140774501";
  var thread_uri = window.location.href;
  var thread_title = window.document.title;
  var thread_fragment = window.location.hash;

  
  var rb_src = "https://my.remarkbox.com/embed" + 
      "?rb_owner_key=" + rb_owner_key +
      "&thread_title=" + encodeURI(thread_title) +
      "&thread_uri=" + encodeURIComponent(thread_uri) + 
      thread_fragment;

  function create_remarkbox_iframe() {
    var ifrm = document.createElement("iframe");
    ifrm.setAttribute("id", "remarkbox-iframe");
    ifrm.setAttribute("scrolling", "no");
    ifrm.setAttribute("src", rb_src);
    ifrm.setAttribute("frameborder", "0");
    ifrm.setAttribute("tabindex", "0");
    ifrm.setAttribute("title", "Remarkbox");
    ifrm.style.width = "100%";
    document.getElementById("remarkbox-div").appendChild(ifrm);
  }
  create_remarkbox_iframe();
  iFrameResize(
    {
      checkOrigin: ["https://my.remarkbox.com"],
      inPageLinks: true,
      initCallback: function(e) {e.iFrameResizer.moveToAnchor(thread_fragment)}
    },
    document.getElementById("remarkbox-iframe")
  );
  document.getElementById("remarkbox-iframe")
</script>

  </main>
  <footer><hr>
<div class="container has-text-centered">
    <div class="accounts">
          <a href="/resume.pdf">Resume</a> • <a href="https://scholar.google.com/citations?user=ED9oDz8AAAAJ&hl=en">Google Scholar</a> • <a href="https://github.com/tbenthompson">GitHub</a> • <a href="https://www.linkedin.com/in/ben-thompson-645292125/">LinkedIn</a> • <a href="mailto:t.ben.thompson@gmail.com">Email</a>
    </div>
    <div class="accounts">
        <a href="http://esantorella.com/">My wife is really smart!</a>
    </div>
    <div class="accounts">
        <a href="https://www.instagram.com/wish.dogg/">My dog has more social media presence than 
        I do.</a>
    </div>
</div>
</footer>

    
</body>

</html>
